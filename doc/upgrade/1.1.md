# Upgrade steps from ezplatform-kernel v1.1 to v1.2

## Internal changes

Changes to parts on which there's no strict backward compatibility promise.

### Image (`ezimage`) External Storage

* The method `\eZ\Publish\Core\FieldType\Image\ImageStorage\Gateway::extractFilesFromXml` has been
  deprecated in favor of `\eZ\Publish\Core\FieldType\Image\ImageStorage::extractOriginalFilePathFromXML`.

  The latter one returns a single path of an original file or null if not found. Legacy Image Variations
  (aliases) are no longer returned since they are generated on the fly and are not stored in that XML
  anymore.

* The protected method `\eZ\Publish\Core\FieldType\Image\ImageStorage\Gateway\DoctrineStorage::canRemoveImageReference`
  has been dropped.

* The responsibility of checking if an image reference can be removed was shifted from Image
  Doctrine gateway to its External Storage. The method
  `\eZ\Publish\Core\FieldType\Image\ImageStorage\Gateway::removeImageReferences`
  now performs removal only, without any prior checks.

* Introduced the method
  `eZ\Publish\Core\FieldType\Image\ImageStorage\Gateway::getImageXMLForOtherVersions`

* `\eZ\Publish\Core\FieldType\Image\ImageStorage` constructor signature has changed:
  * Dropped injection of unused Services `\eZ\Publish\Core\IO\MetadataHandler` and
    `\eZ\Publish\Core\Base\Utils\DeprecationWarnerInterface`,
  * Injected `\eZ\Publish\Core\IO\UrlRedecoratorInterface` and `\Psr\Log\LoggerInterface`.
